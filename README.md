# DockerStudies
Тренировочный проект - докер + dotnet

**Задача**: написать dotnet-приложение, работающее в многоконтейнерной среде.

Готовый сервис должен содержать:
- Web API;
- Базу данных postgresql;
- Кэш в redis;

## Вводные

### Web API
API должно содержать буквально 2-3 эндпоинта, один для получения информации, другой для добавления; авторизация не нужна. Сервис ходит в БД в контейнере при помощи Npgsql. 
Для работы сервиса нужно сделать минимум 2 проекта - один с API, другой с какой-нибудь выдуманной бизнес-логикой (при выдумывании опираться на содержимое тестовой БД, см. ниже).

### БД
Для работы используется официальный докер-образ postgresql:15. Сама база кладётся в volume.

## Подготовка
Для работы используется демо-база авиаперевозок от PostgresPro - [посмотреть описание, скачать](https://postgrespro.ru/docs/postgrespro/9.6/demodb-bookings)

Чтообы инициализировать БД, кладём sql-скрипт с дампом базы в папку **pg_init** и переименовываем файл так, чтобы он при развёртывании образа был обработан после `01_init.sh` и перед `20_after_restore.sh`, например, `10_demo-small-20170815.sql`.

Для инициализации контейнера с последующим заполнением БД используем команду:
```bash
docker run -d --name pg-aircraft \
	-e POSTGRES_PASSWORD=pgpass \
	--mount type=volume,source=pg-aircraft,dst=/var/lib/postgresql/data \
	--mount type=bind,source=/absolute/path/to/pg_init,dst=/docker-entrypoint-initdb.d \
	-p 5432:5432 \
	postgres:15 
```


Для старта контейнера с заполненной базой используем команду:
```bash
docker run -d --name pg-aircraft \
	-e POSTGRES_PASSWORD=pgpass \
	--mount type=volume,source=pg-aircraft,dst=/var/lib/postgresql/data \
	-p 5432:5432 \
	postgres:15 
```

## Фичи проекта

### Бронирование билетов
Отправляем POST-запрос с данными пассажира, рейсом и местом, создаём бронирование;

### Просмотр истории бронирований для одного пассажира
Просматриваем историю бронирований конкретного пассажира - прошлые и будущие перелёты. Результат можно кэшировать.
